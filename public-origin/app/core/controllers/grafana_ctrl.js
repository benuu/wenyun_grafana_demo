/*! grafana - v2.6.0 - 2015-12-14
 * Copyright (c) 2015 Torkel Ã–degaard; Licensed Apache-2.0 */

define(["angular","lodash","jquery","../core_module","app/core/config","app/core/store"],function(a,b,c,d,e,f){"use strict";d.controller("GrafanaCtrl",["$scope","alertSrv","utilSrv","$rootScope","$controller","contextSrv",function(d,g,h,i,j,k){d.init=function(){d.contextSrv=k,d._=b,i.profilingEnabled=f.getBool("profilingEnabled"),i.performance={loadStart:(new Date).getTime()},i.appSubUrl=e.appSubUrl,i.profilingEnabled&&d.initProfiling(),g.init(),h.init(),d.dashAlerts=g},d.initDashboard=function(a,b){j("DashboardCtrl",{$scope:b}).init(a)},i.onAppEvent=function(a,b,c){var d=i.$on(a,b),e=this;1!==e.$id||c||console.log("warning rootScope onAppEvent called without localscope"),c&&(e=c),e.$on("$destroy",d)},i.appEvent=function(a,b){i.$emit(a,b)},i.colors=["#7EB26D","#EAB839","#6ED0E0","#EF843C","#E24D42","#1F78C1","#BA43A9","#705DA0","#508642","#CCA300","#447EBC","#C15C17","#890F02","#0A437C","#6D1F62","#584477","#B7DBAB","#F4D598","#70DBED","#F9BA8F","#F29191","#82B5D8","#E5A8E2","#AEA2E0","#629E51","#E5AC0E","#64B0C8","#E0752D","#BF1B00","#0A50A1","#962D82","#614D93","#9AC48A","#F2C96D","#65C5DB","#F9934E","#EA6460","#5195CE","#D683CE","#806EB7","#3F6833","#967302","#2F575E","#99440A","#58140C","#052B51","#511749","#3F2B5B","#E0F9D7","#FCEACA","#CFFAFF","#F9E2D2","#FCE2DE","#BADFF4","#F9D9F9","#DEDAF7"],d.getTotalWatcherCount=function(){var b=0,d=0,e=c(document.getElementsByTagName("body")),f=function(e){e.data().hasOwnProperty("$scope")&&(d++,a.forEach(e.data().$scope.$$watchers,function(){b++})),a.forEach(e.children(),function(a){f(c(a))})};return f(e),i.performance.scopeCount=d,b},d.initProfiling=function(){var a=0;d.$watch(function(){a++},function(){}),i.performance.panels=[],d.$on("refresh",function(){if(i.performance.panels.length>0){var a=0,c=0;b.each(i.performance.panels,function(b){a+=b.render,c+=b.query}),console.log("total query: "+c),console.log("total render: "+a),console.log("avg render: "+a/i.performance.panels.length)}i.performance.panels=[]}),d.onAppEvent("dashboard-loaded",function(){a=0,setTimeout(function(){console.log("Dashboard::Performance Total Digests: "+a),console.log("Dashboard::Performance Total Watchers: "+d.getTotalWatcherCount()),console.log("Dashboard::Performance Total ScopeCount: "+i.performance.scopeCount);var b=i.performance.allPanelsInitialized-i.performance.dashboardLoadStart;console.log("Dashboard::Performance - All panels initialized in "+b+" ms");for(var c=window.performance.now(),e=0;30>e;e++)i.$apply();console.log("Dashboard::Performance Root Digest "+(window.performance.now()-c)/30)},3e3)})},d.init()}])});