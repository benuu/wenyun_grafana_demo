/*! grafana - v2.6.0 - 2015-12-14
 * Copyright (c) 2015 Torkel Ã–degaard; Licensed Apache-2.0 */

define(["require","exports","angular","jquery","lodash","./controller","./renderer","./editor"],function(a,b,c,d,e,f,g,h){function i(){"use strict";return{restrict:"E",templateUrl:"app/panels/table/module.html",controller:f.TablePanelCtrl,link:function(a,b){function c(){var b=a.height||a.panel.height||a.row.height;return e.isString(b)&&(b=parseInt(b.replace("px",""),10)),m>1&&(b-=28),b-60+"px"}function f(b){var c=new g.TableRenderer(l,k,a.dashboard.timezone);b.empty(),b.html(c.render(a.pageIndex))}function h(b){var c=d(b.currentTarget);a.pageIndex=parseInt(c.text(),10)-1,j()}function i(b){b.empty();var c=l.pageSize||100;if(m=Math.ceil(k.rows.length/c),1!==m){for(var e=Math.max(a.pageIndex-3,0),f=Math.min(m,e+9),g=d("<ul></ul>"),h=e;f>h;h++){var i=h===a.pageIndex?"active":"",j=d('<li><a class="table-panel-page-link pointer '+i+'">'+(h+1)+"</a></li>");g.append(j)}b.append(g)}}function j(){var a=b.find(".table-panel-container"),d=b.find(".table-panel-scroll"),e=b.find("tbody"),g=b.find(".table-panel-footer");f(e),a.css({"font-size":l.fontSize}),i(g),d.css({"max-height":l.scroll?c():""})}var k,l=a.panel,m=0;b.on("click",".table-panel-page-link",h),a.$on("$destroy",function(){b.off("click",".table-panel-page-link")}),a.$on("render",function(b,c){return(k=c||k)?void j():void a.get_data()})}}}b.tablePanel=i,c.module("grafana.directives").directive("grafanaPanelTable",i),c.module("grafana.directives").directive("grafanaPanelTableEditor",h.tablePanelEditor)});