/*! grafana - v2.6.0 - 2015-12-14
 * Copyright (c) 2015 Torkel Ã–degaard; Licensed Apache-2.0 */

define(["lodash","app/core/utils/datemath"],function(a,b){"use strict";function c(){var b=this;this.datasource={},this.$element={},this.annotationsSrv={},this.timeSrv=new f,this.templateSrv=new h,this.datasourceSrv={getMetricSources:function(){},get:function(){return{then:function(a){a(b.datasource)}}}},this.providePhase=function(c){return module(function(d){d.value("datasourceSrv",b.datasourceSrv),d.value("annotationsSrv",b.annotationsSrv),d.value("timeSrv",b.timeSrv),d.value("templateSrv",b.templateSrv),d.value("$element",b.$element),a.each(c,function(a,b){d.value(b,a)})})},this.createControllerPhase=function(a){return inject(function(c,d,f,g,h){b.scope=d.$new(),b.$location=g,b.$browser=h,b.scope.contextSrv={},b.scope.panel={},b.scope.row={panels:[]},b.scope.dashboard={},b.scope.dashboardMeta={},b.scope.dashboardViewState=new e,b.scope.appEvent=sinon.spy(),b.scope.onAppEvent=sinon.spy(),d.colors=[];for(var i=0;50>i;i++)d.colors.push("#"+i);b.$q=f,b.scope.skipDataOnInit=!0,b.scope.skipAutoInit=!0,b.controller=c(a,{$scope:b.scope})})}}function d(){var b=this;b.templateSrv=new h,b.timeSrv=new f,b.datasourceSrv={},b.backendSrv={},b.$location={},b.$routeParams={},this.providePhase=function(c){return module(function(d){a.each(c,function(a){d.value(a,b[a])})})},this.createService=function(a){return inject(function(c,d,e,f){b.$q=c,b.$rootScope=d,b.$httpBackend=e,b.$rootScope.onAppEvent=function(){},b.$rootScope.appEvent=function(){},b.service=f.get(a)})}}function e(){this.registerPanel=function(){}}function f(){this.init=sinon.spy(),this.time={from:"now-1h",to:"now"},this.timeRange=function(a){return a===!1?this.time:{from:b.parse(this.time.from,!1),to:b.parse(this.time.to,!0)}},this.replace=function(a){return a}}function g(){this.hasRole=function(){return!0}}function h(){this.variables=[],this.templateSettings={interpolate:/\[\[([\s\S]+?)\]\]/g},this.data={},this.replace=function(b){return a.template(b,this.data,this.templateSettings)},this.init=function(){},this.fillVariableValuesForUrl=function(){},this.updateTemplateData=function(){},this.variableExists=function(){return!1},this.highlightVariablesAsHtml=function(a){return a},this.setGrafanaVariable=function(a,b){this.data[a]=b}}return{ControllerTestContext:c,TimeSrvStub:f,ContextSrvStub:g,ServiceTestContext:d}});